# 도커 기본

### 도커 사용 이유

- 어떠한 프로그램을 다운 받는 과정을 굉장히 간단하게 만들기 위함.

### 도커는 무엇인가요 ?

- 컨테이너를 사용하여 응용프로그램을 더 쉽게 만들고 배포하고 실행할 수 있도록 설계된 도구 이며 컨테이너 기반의 오픈소스 가상화 플랫폼이며 생태계
- **서버에서의 컨테이너의 개념**
    - 컨테이너 안에 다양한 프로그램, 실행환경을 컨테이너로 추상화하고 동일한 인터페이스를 제공하여 프로그램의 배포 및 관리를 지원
    - 일반 컨테이너의 개념에서 물건을 손쉽게 운송 해주는 것 처럼 프로그램을 손쉽게 이동 배포 및 관리를 해줌

### 도커 컨테이너

- **컨테이너**는 ****코드와 모든 종속성을 패키지화 하여 응용 프로그램이 한 컴퓨팅 환경에서 다른 컴퓨팅 환경으로 빠르고 안정적으로 실행되도록 하는 소프트웨어 표준 단위
- **컨테이너 이미지**는 코드, 런타임, 시스템 도구, 시스템 라이브러리 및 설정과 같은 **응용 프로그램을 실행하는데 필요한 모든 것을 포함**하는 가볍고 독립적인 실행 가능한 소프트웨어 패키지
- **도커에서 컨테이너 코드 및 이미지**
    - 도커 컨테이너의 경우 도커 엔진에서 실행될 때 이미지가 컨테이너가 됨
    

### 도커 이미지

- **도커 이미지** :  컨테이너 생성을 위해 필요한 설정이나 종속성들을 갖고 있는 소프트웨어 패키지
- `Dockerhub`에 이미 다른 사람들이 만들어 놓은 것을 이용할 수도 있음
- 직접 도커 이미지를 만들어서 사용할 수도 있으며, 직접 만든 것을 `Dockerhub`에 업로드 가능
- **도커 이미지 생성 순서**
    - `Dockerfile 작성` → `도커 클라이언트` → `도커 서버` → `이미지 생성`
    - **도커 파일 작성** : 도커 파일이란 도커 이미지를 만들기 위한 설정 파일입니다. 컨테이너가 어떻게 행동해야 하는지에 대한 설정을 정의합니다.
    - **도커 클라이언트** : 도커 파일에 입력된 명령들이 도커 클라이언트에 전달되어야 됩니다.
    - **도커 서버** : 도커 클라이언트에 전달된 모든 중요한 작업들을 하는 곳.
    

### 도커 동작 방식 ( **`docker run hello-world`** )

1. 도커 클라이언트에 커맨드를 입력시 클라이언트에서 도커 서버로 요청
2. 서버에서 `hello-world`라는 이미지가 이미 로컬에 `cache`가 되어 있는지 확인
    - 현재 존재하지 않을 경우 `Unable to find image ~`라는 문구가 2번째 줄에 표시
    - `Docker Hub`의 이미지 저장소에서 이미지를 가져오고 로컬 `Cache`로 보관
3. 이미지 존재시 그 이미지를 이용해서 컨테이너를 생성

### 도커와 기존의 가상기술과의 차이

![Untitled](%E1%84%83%E1%85%A9%E1%84%8F%E1%85%A5%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%2043983aed32ae4cfbbdeb3c5d4f20bd4d/Untitled.png)

- **가상화 기술이 나오기 전**
    - **한대의 서버를 하나의 용도로만 사용**
        - 남는 서버 공간 방치 및 하나의 서버에 하나의 운영체제 및 하나의 프로그램 만을 운영
        - 안정적이지만 비효율적인 방식
- **하이퍼 바이저 기반의 가상화 출현**
    - 논리적으로 공간을 분할하여 `VM`이라는 독립적인 가상 환경의 서버 이용 가능
        - 하이퍼 바이저는 호스트 시스템에서 다수의 `OS`를 구동할 수 있게 하는 소프트웨어
    - **하이퍼 바이저 기반 VM 구조**
        - `VM`은 각 `VM`마다 독립된 가상의 하드웨어 자원을 할당 받음.
        - 논리적으로 분리되어 있어 한 `VM`에 오류가 발생해도 다른 `VM`으로 전이되지 않음
- **가상화 컨테이너 기술**
    - `VM`과 비교시 컨테이너는 하이버바이저와 추가 `OS`가 필요하지 않기에 가벼움.
    - **기존 가상화 기술과의 공통점**
        - 기본 하드웨어에서 격리된 환경에 애플리케이션을 배치하는 방법

### 도커 컨테이너 격리 방법

- 리눅스의 `Cgroup(control groups)`과 `네임스페이스(namespaces)` 사용
- **Cgroup** : `CPU`, `메모리`, `Network Bandwith`, `HD i/o` 등 프로세스 그룹의 시스템 리소스 사용량을 관리
    - 어플에 사용량이 많을 시 `Cgroup`에서 `CPU`와 메모리 사용 제한 가능
- **네임스페이스 :** 하나의 시스템에서 프로세스를 격리시킬 수 있는 가상화 기술 별개의 독립된 공간을 사용하는 것처럼 격리된 환경을 제공하는 경량 프로세스 가상화 기술

### 이미지를 이용한 컨테이너 생성 과정

![Untitled](%E1%84%83%E1%85%A9%E1%84%8F%E1%85%A5%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%2043983aed32ae4cfbbdeb3c5d4f20bd4d/Untitled%201.png)

1. `Docker 클라이언트`에 `docker run <이미지>` 커맨드 입력
2. 도커 이미지에 있는 파일 스냅샷(실행파일)을 컨테이너 하드 디스크에 옮김
3. 이미지에서 가지고 있는 명령어 (컨테이너가 실행 명령어)를 이용해서 `APP`을 실행시켜줍니다.